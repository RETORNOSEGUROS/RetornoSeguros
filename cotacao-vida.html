<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Cota√ß√£o Seguro de Vida | Retorno Seguros</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Plus+Jakarta+Sans:wght@400;500;600;700;800&display=swap" rel="stylesheet">
    
    <!-- Firebase SDK -->
    <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-firestore-compat.js"></script>
    
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        :root {
            --primary: #0088aa;
            --primary-dark: #006680;
            --secondary: #00b8d4;
            --dark-blue: #004d66;
            --light-bg: #f0f9fb;
            --white: #ffffff;
            --text-dark: #1a2b3c;
            --text-light: #5a6b7c;
            --success: #10b981;
            --warning: #f59e0b;
            --error: #ef4444;
            --purple: #8b5cf6;
            --shadow: 0 4px 20px rgba(0, 136, 170, 0.15);
            --shadow-lg: 0 10px 40px rgba(0, 136, 170, 0.2);
        }

        body {
            font-family: 'Plus Jakarta Sans', sans-serif;
            background: linear-gradient(135deg, var(--light-bg) 0%, #e6f4f7 100%);
            min-height: 100vh;
            color: var(--text-dark);
            overflow-x: hidden;
        }

        .header {
            background: var(--white);
            padding: 1rem 1.5rem;
            box-shadow: 0 2px 10px rgba(0,0,0,0.08);
            position: sticky;
            top: 0;
            z-index: 100;
        }

        .header-content {
            max-width: 600px;
            margin: 0 auto;
            display: flex;
            align-items: center;
            justify-content: space-between;
        }

        .logo {
            display: flex;
            align-items: center;
            gap: 0.75rem;
            text-decoration: none;
        }

        .logo-icon {
            width: 40px;
            height: 40px;
            background: linear-gradient(135deg, var(--primary), var(--secondary));
            border-radius: 10px;
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-weight: 800;
            font-size: 1.2rem;
        }

        .logo-text-container {
            display: flex;
            flex-direction: column;
        }

        .logo-text {
            font-weight: 800;
            font-size: 1.3rem;
            color: var(--text-dark);
            letter-spacing: -0.5px;
        }

        .logo-sub {
            font-size: 0.7rem;
            color: var(--primary);
            font-weight: 600;
            letter-spacing: 0.5px;
            text-transform: uppercase;
        }

        .progress-container {
            max-width: 600px;
            margin: 0 auto;
            padding: 1.5rem;
        }

        .progress-bar-wrapper {
            background: rgba(0, 136, 170, 0.15);
            border-radius: 10px;
            height: 8px;
            overflow: hidden;
            margin-bottom: 0.75rem;
        }

        .progress-bar-fill {
            background: linear-gradient(90deg, var(--primary), var(--secondary));
            height: 100%;
            border-radius: 10px;
            transition: width 0.4s ease;
        }

        .progress-text {
            text-align: center;
            font-size: 0.85rem;
            color: var(--text-light);
            font-weight: 500;
        }

        .main-container {
            max-width: 600px;
            margin: 0 auto;
            padding: 0 1.5rem 3rem;
        }

        .step-card {
            background: var(--white);
            border-radius: 20px;
            padding: 2rem 1.5rem;
            box-shadow: var(--shadow);
            display: none;
            animation: slideIn 0.4s ease;
        }

        .step-card.active {
            display: block;
        }

        @keyframes slideIn {
            from {
                opacity: 0;
                transform: translateY(20px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        .step-icon {
            width: 60px;
            height: 60px;
            background: linear-gradient(135deg, var(--light-bg), #e0f2f5);
            border-radius: 16px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.75rem;
            margin: 0 auto 1.25rem;
        }

        .step-title {
            text-align: center;
            font-size: 1.5rem;
            font-weight: 700;
            margin-bottom: 0.5rem;
            color: var(--text-dark);
        }

        .step-subtitle {
            text-align: center;
            color: var(--text-light);
            margin-bottom: 1.5rem;
            font-size: 0.95rem;
            line-height: 1.5;
        }

        .greeting-name {
            color: var(--primary);
        }

        .input-group {
            margin-bottom: 1.5rem;
        }

        .input-label {
            display: block;
            font-weight: 600;
            margin-bottom: 0.5rem;
            color: var(--text-dark);
        }

        .text-input, .select-input {
            width: 100%;
            padding: 1rem 1.25rem;
            border: 2px solid #e5e9ec;
            border-radius: 12px;
            font-size: 1rem;
            font-family: inherit;
            transition: all 0.3s ease;
            background: var(--white);
        }

        .text-input:focus, .select-input:focus {
            outline: none;
            border-color: var(--primary);
            box-shadow: 0 0 0 4px rgba(0, 136, 170, 0.1);
        }

        .options-grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 0.75rem;
            margin-bottom: 1.5rem;
        }

        .options-grid.single-col {
            grid-template-columns: 1fr;
        }

        .options-grid.three-cols {
            grid-template-columns: repeat(3, 1fr);
        }

        .option-btn {
            background: var(--white);
            border: 2px solid #e5e9ec;
            border-radius: 14px;
            padding: 1.25rem 1rem;
            cursor: pointer;
            transition: all 0.3s ease;
            display: flex;
            flex-direction: column;
            align-items: center;
            text-align: center;
            gap: 0.5rem;
        }

        .option-btn:hover {
            border-color: var(--primary);
            transform: translateY(-2px);
        }

        .option-btn.selected {
            border-color: var(--primary);
            background: rgba(0, 136, 170, 0.05);
        }

        .option-icon {
            font-size: 1.5rem;
        }

        .option-text {
            font-weight: 600;
            color: var(--text-dark);
            font-size: 0.95rem;
        }

        .option-desc {
            font-size: 0.8rem;
            color: var(--text-light);
        }

        .btn-container {
            display: flex;
            gap: 0.75rem;
            margin-top: 1.5rem;
        }

        .btn {
            flex: 1;
            padding: 1rem 1.5rem;
            border-radius: 12px;
            font-size: 1rem;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            font-family: inherit;
            border: none;
        }

        .btn-primary {
            background: linear-gradient(135deg, var(--primary), var(--primary-dark));
            color: white;
        }

        .btn-primary:hover:not(:disabled) {
            transform: translateY(-2px);
            box-shadow: var(--shadow);
        }

        .btn-primary:disabled {
            opacity: 0.5;
            cursor: not-allowed;
        }

        .btn-secondary {
            background: var(--light-bg);
            color: var(--text-dark);
        }

        .btn-secondary:hover {
            background: #e0f2f5;
        }

        /* Coverage Cards com explica√ß√µes */
        .coverage-card {
            border: 2px solid #e5e9ec;
            border-radius: 14px;
            padding: 1.25rem;
            margin-bottom: 0.75rem;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .coverage-card:hover {
            border-color: var(--primary);
        }

        .coverage-card.selected {
            border-color: var(--primary);
            background: rgba(0, 136, 170, 0.05);
        }

        .coverage-card.recommended {
            border-color: var(--success);
            background: rgba(16, 185, 129, 0.05);
        }

        .coverage-card.recommended::before {
            content: '‚≠ê Recomendado para voc√™';
            display: block;
            font-size: 0.75rem;
            color: var(--success);
            font-weight: 600;
            margin-bottom: 0.5rem;
        }

        .coverage-header {
            display: flex;
            align-items: center;
            gap: 0.75rem;
            margin-bottom: 0.5rem;
        }

        .coverage-checkbox {
            width: 24px;
            height: 24px;
            border: 2px solid #d0d5dd;
            border-radius: 6px;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: all 0.3s ease;
            flex-shrink: 0;
        }

        .coverage-card.selected .coverage-checkbox {
            background: var(--primary);
            border-color: var(--primary);
        }

        .coverage-card.selected .coverage-checkbox::after {
            content: '‚úì';
            color: white;
            font-weight: 700;
            font-size: 0.8rem;
        }

        .coverage-title {
            font-weight: 600;
            color: var(--text-dark);
            font-size: 1rem;
        }

        .coverage-explain {
            font-size: 0.85rem;
            color: var(--text-light);
            line-height: 1.5;
            margin-bottom: 0.5rem;
            padding-left: 2.25rem;
        }

        .coverage-example {
            background: var(--light-bg);
            border-radius: 8px;
            padding: 0.75rem;
            font-size: 0.8rem;
            color: var(--text-dark);
            margin-left: 2.25rem;
        }

        .coverage-example strong {
            color: var(--primary);
        }

        /* Result Styles */
        .result-section {
            margin-bottom: 1.5rem;
        }

        .result-card {
            background: linear-gradient(135deg, var(--primary), var(--dark-blue));
            border-radius: 20px;
            padding: 2rem;
            color: white;
            text-align: center;
            margin-bottom: 1.5rem;
        }

        .result-label {
            font-size: 0.9rem;
            opacity: 0.9;
            margin-bottom: 0.5rem;
        }

        .result-value {
            font-size: 2.5rem;
            font-weight: 800;
            margin-bottom: 0.25rem;
        }

        .result-installment {
            font-size: 1rem;
            opacity: 0.9;
        }

        /* Recommendation Card */
        .recommendation-card {
            background: linear-gradient(135deg, rgba(139, 92, 246, 0.1), rgba(0, 136, 170, 0.1));
            border: 2px solid var(--purple);
            border-radius: 16px;
            padding: 1.5rem;
            margin-bottom: 1.5rem;
        }

        .recommendation-header {
            display: flex;
            align-items: center;
            gap: 0.75rem;
            margin-bottom: 1rem;
        }

        .recommendation-icon {
            width: 40px;
            height: 40px;
            background: var(--purple);
            border-radius: 10px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.25rem;
        }

        .recommendation-title {
            font-weight: 700;
            color: var(--text-dark);
        }

        .recommendation-subtitle {
            font-size: 0.85rem;
            color: var(--text-light);
        }

        .recommendation-content {
            display: flex;
            flex-direction: column;
            gap: 1rem;
        }

        .recommendation-item {
            display: flex;
            align-items: center;
            gap: 1rem;
        }

        .recommendation-value {
            font-size: 1.5rem;
            font-weight: 800;
            color: var(--purple);
            min-width: 100px;
        }

        .recommendation-text {
            font-size: 0.9rem;
            color: var(--text-dark);
        }

        /* Protection Score */
        .protection-score {
            background: var(--white);
            border: 2px solid #e5e9ec;
            border-radius: 16px;
            padding: 1.5rem;
            margin-bottom: 1.5rem;
            text-align: center;
        }

        .score-title {
            font-size: 0.9rem;
            color: var(--text-light);
            margin-bottom: 0.75rem;
        }

        .score-circle {
            width: 120px;
            height: 120px;
            border-radius: 50%;
            background: conic-gradient(var(--success) var(--score-percent), #e5e9ec var(--score-percent));
            display: flex;
            align-items: center;
            justify-content: center;
            margin: 0 auto 1rem;
            position: relative;
        }

        .score-circle::before {
            content: '';
            width: 90px;
            height: 90px;
            background: var(--white);
            border-radius: 50%;
            position: absolute;
        }

        .score-value {
            position: relative;
            z-index: 1;
            font-size: 1.75rem;
            font-weight: 800;
            color: var(--success);
        }

        .score-label {
            font-size: 0.85rem;
            color: var(--text-light);
        }

        .score-factors {
            display: flex;
            flex-wrap: wrap;
            gap: 0.5rem;
            justify-content: center;
            margin-top: 1rem;
        }

        .score-factor {
            background: var(--light-bg);
            padding: 0.35rem 0.75rem;
            border-radius: 20px;
            font-size: 0.75rem;
            color: var(--text-dark);
        }

        .score-factor.positive {
            background: rgba(16, 185, 129, 0.15);
            color: var(--success);
        }

        .score-factor.warning {
            background: rgba(245, 158, 11, 0.15);
            color: var(--warning);
        }

        /* Summary */
        .summary-list {
            background: var(--light-bg);
            border-radius: 12px;
            padding: 1rem;
            margin-bottom: 1.5rem;
        }

        .summary-item {
            display: flex;
            justify-content: space-between;
            padding: 0.5rem 0;
            font-size: 0.9rem;
            border-bottom: 1px solid rgba(0,0,0,0.05);
        }

        .summary-item:last-child {
            border-bottom: none;
        }

        .summary-label {
            color: var(--text-light);
        }

        .summary-value {
            font-weight: 600;
            color: var(--text-dark);
        }

        .whatsapp-btn {
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 0.75rem;
            width: 100%;
            padding: 1rem;
            background: #25D366;
            color: white;
            text-decoration: none;
            border-radius: 12px;
            font-weight: 600;
            font-size: 1rem;
            transition: all 0.3s ease;
        }

        .whatsapp-btn:hover {
            background: #20bd5a;
            transform: translateY(-2px);
        }

        .info-box {
            background: var(--light-bg);
            border-radius: 12px;
            padding: 1rem;
            margin-bottom: 1.5rem;
        }

        .info-box p {
            font-size: 0.9rem;
            color: var(--text-light);
            line-height: 1.5;
        }

        .info-box strong {
            color: var(--primary);
        }

        .info-tooltip {
            background: var(--light-bg);
            border-radius: 10px;
            padding: 0.875rem 1rem;
            font-size: 0.85rem;
            color: var(--text-light);
            margin-top: 1rem;
            display: flex;
            align-items: flex-start;
            gap: 0.5rem;
        }

        .info-tooltip::before {
            content: '‚ÑπÔ∏è';
        }

        @media (max-width: 480px) {
            .step-card {
                padding: 1.5rem 1.25rem;
            }

            .step-title {
                font-size: 1.3rem;
            }

            .result-value {
                font-size: 2rem;
            }

            .options-grid {
                grid-template-columns: 1fr;
            }

            .options-grid.three-cols {
                grid-template-columns: 1fr 1fr;
            }
        }
    </style>
</head>
<body>
    <!-- Header -->
    <header class="header">
        <div class="header-content">
            <a href="#" class="logo">
                <div class="logo-icon">R</div>
                <div class="logo-text-container">
                    <span class="logo-text">Retorno</span>
                    <span class="logo-sub">Seguros</span>
                </div>
            </a>
        </div>
    </header>

    <!-- Progress -->
    <div class="progress-container">
        <div class="progress-bar-wrapper">
            <div class="progress-bar-fill" id="progressBar" style="width: 12.5%"></div>
        </div>
        <div class="progress-text" id="progressText">Passo 1 de 8</div>
    </div>

    <!-- Main Container -->
    <div class="main-container">
        
        <!-- Step 1: Nome -->
        <div class="step-card active" id="step1">
            <div class="step-icon">üíú</div>
            <h2 class="step-title">Proteja quem voc√™ ama</h2>
            <p class="step-subtitle">Vamos criar uma prote√ß√£o sob medida para sua fam√≠lia. Como posso te chamar?</p>
            
            <div class="input-group">
                <input type="text" class="text-input" id="userName" placeholder="Seu nome" autocomplete="off">
            </div>

            <div class="btn-container">
                <button class="btn btn-primary" onclick="nextStep(1)" id="btnStep1">Come√ßar</button>
            </div>
        </div>

        <!-- Step 2: Idade -->
        <div class="step-card" id="step2">
            <div class="step-icon">üéÇ</div>
            <h2 class="step-title">Ol√°, <span class="greeting-name" id="greetingName"></span>!</h2>
            <p class="step-subtitle">Qual sua faixa de idade?</p>
            
            <div class="options-grid three-cols">
                <div class="option-btn" onclick="selectOption(this, 'idade', '18-30')">
                    <span class="option-text">18 a 30</span>
                </div>
                <div class="option-btn" onclick="selectOption(this, 'idade', '31-40')">
                    <span class="option-text">31 a 40</span>
                </div>
                <div class="option-btn" onclick="selectOption(this, 'idade', '41-50')">
                    <span class="option-text">41 a 50</span>
                </div>
                <div class="option-btn" onclick="selectOption(this, 'idade', '51-60')">
                    <span class="option-text">51 a 60</span>
                </div>
                <div class="option-btn" onclick="selectOption(this, 'idade', '61-65')">
                    <span class="option-text">61 a 65</span>
                </div>
                <div class="option-btn" onclick="selectOption(this, 'idade', '66+')">
                    <span class="option-text">66+</span>
                </div>
            </div>

            <div class="btn-container">
                <button class="btn btn-secondary" onclick="prevStep(2)">Voltar</button>
                <button class="btn btn-primary" onclick="nextStep(2)" disabled id="btnStep2">Continuar</button>
            </div>
        </div>

        <!-- Step 3: Fam√≠lia -->
        <div class="step-card" id="step3">
            <div class="step-icon">üë®‚Äçüë©‚Äçüëß‚Äçüë¶</div>
            <h2 class="step-title">Sobre sua fam√≠lia</h2>
            <p class="step-subtitle">Isso nos ajuda a calcular a prote√ß√£o ideal</p>
            
            <div class="options-grid single-col">
                <div class="option-btn" onclick="selectOption(this, 'familia', 'solteiro')">
                    <span class="option-icon">üë§</span>
                    <span class="option-text">Solteiro(a), sem filhos</span>
                </div>
                <div class="option-btn" onclick="selectOption(this, 'familia', 'casal')">
                    <span class="option-icon">üë´</span>
                    <span class="option-text">Casado(a), sem filhos</span>
                </div>
                <div class="option-btn" onclick="selectOption(this, 'familia', 'filhos_pequenos')">
                    <span class="option-icon">üë®‚Äçüë©‚Äçüëß</span>
                    <span class="option-text">Tenho filhos menores de 18 anos</span>
                    <span class="option-desc">Prote√ß√£o mais importante</span>
                </div>
                <div class="option-btn" onclick="selectOption(this, 'familia', 'filhos_adultos')">
                    <span class="option-icon">üë®‚Äçüë©‚Äçüëß‚Äçüë¶</span>
                    <span class="option-text">Filhos j√° s√£o adultos</span>
                </div>
            </div>

            <div class="btn-container">
                <button class="btn btn-secondary" onclick="prevStep(3)">Voltar</button>
                <button class="btn btn-primary" onclick="nextStep(3)" disabled id="btnStep3">Continuar</button>
            </div>
        </div>

        <!-- Step 4: Profiss√£o -->
        <div class="step-card" id="step4">
            <div class="step-icon">üíº</div>
            <h2 class="step-title">Sua atividade profissional</h2>
            <p class="step-subtitle">Algumas profiss√µes t√™m condi√ß√µes especiais</p>
            
            <div class="options-grid">
                <div class="option-btn" onclick="selectOption(this, 'profissao', 'clt')">
                    <span class="option-icon">üè¢</span>
                    <span class="option-text">CLT</span>
                    <span class="option-desc">Empregado</span>
                </div>
                <div class="option-btn" onclick="selectOption(this, 'profissao', 'servidor')">
                    <span class="option-icon">üèõÔ∏è</span>
                    <span class="option-text">Servidor P√∫blico</span>
                </div>
                <div class="option-btn" onclick="selectOption(this, 'profissao', 'autonomo')">
                    <span class="option-icon">üîß</span>
                    <span class="option-text">Aut√¥nomo</span>
                    <span class="option-desc">Profissional liberal</span>
                </div>
                <div class="option-btn" onclick="selectOption(this, 'profissao', 'empresario')">
                    <span class="option-icon">üè™</span>
                    <span class="option-text">Empres√°rio</span>
                    <span class="option-desc">S√≥cio / Propriet√°rio</span>
                </div>
                <div class="option-btn" onclick="selectOption(this, 'profissao', 'aposentado')">
                    <span class="option-icon">üå¥</span>
                    <span class="option-text">Aposentado</span>
                </div>
                <div class="option-btn" onclick="selectOption(this, 'profissao', 'outro')">
                    <span class="option-icon">üìã</span>
                    <span class="option-text">Outro</span>
                </div>
            </div>

            <div class="btn-container">
                <button class="btn btn-secondary" onclick="prevStep(4)">Voltar</button>
                <button class="btn btn-primary" onclick="nextStep(4)" disabled id="btnStep4">Continuar</button>
            </div>
        </div>

        <!-- Step 5: Renda -->
        <div class="step-card" id="step5">
            <div class="step-icon">üíµ</div>
            <h2 class="step-title">Sua renda mensal</h2>
            <p class="step-subtitle">Usamos para calcular o capital ideal. Seus dados s√£o confidenciais.</p>
            
            <div class="options-grid single-col">
                <div class="option-btn" onclick="selectOption(this, 'renda', '3000')">
                    <span class="option-text">At√© R$ 3.000</span>
                </div>
                <div class="option-btn" onclick="selectOption(this, 'renda', '5000')">
                    <span class="option-text">R$ 3.000 a R$ 5.000</span>
                </div>
                <div class="option-btn" onclick="selectOption(this, 'renda', '8000')">
                    <span class="option-text">R$ 5.000 a R$ 8.000</span>
                </div>
                <div class="option-btn" onclick="selectOption(this, 'renda', '12000')">
                    <span class="option-text">R$ 8.000 a R$ 12.000</span>
                </div>
                <div class="option-btn" onclick="selectOption(this, 'renda', '20000')">
                    <span class="option-text">R$ 12.000 a R$ 20.000</span>
                </div>
                <div class="option-btn" onclick="selectOption(this, 'renda', '30000')">
                    <span class="option-text">Acima de R$ 20.000</span>
                </div>
            </div>

            <div class="btn-container">
                <button class="btn btn-secondary" onclick="prevStep(5)">Voltar</button>
                <button class="btn btn-primary" onclick="nextStep(5)" disabled id="btnStep5">Continuar</button>
            </div>
        </div>

        <!-- Step 6: Hist√≥rico Familiar -->
        <div class="step-card" id="step6">
            <div class="step-icon">üß¨</div>
            <h2 class="step-title">Hist√≥rico de sa√∫de familiar</h2>
            <p class="step-subtitle">Pais ou irm√£os tiveram alguma dessas condi√ß√µes antes dos 60 anos?</p>
            
            <div class="info-box">
                <p>üí° Isso nos ajuda a recomendar coberturas adicionais que podem ser importantes para voc√™. <strong>N√£o afeta o pre√ßo</strong>, apenas nossas sugest√µes.</p>
            </div>
            
            <div class="options-grid">
                <div class="option-btn" onclick="toggleHistorico(this, 'cardiaco')">
                    <span class="option-icon">‚ù§Ô∏è</span>
                    <span class="option-text">Problemas card√≠acos</span>
                    <span class="option-desc">Infarto, AVC</span>
                </div>
                <div class="option-btn" onclick="toggleHistorico(this, 'cancer')">
                    <span class="option-icon">üéóÔ∏è</span>
                    <span class="option-text">C√¢ncer</span>
                </div>
                <div class="option-btn" onclick="toggleHistorico(this, 'diabetes')">
                    <span class="option-icon">üíâ</span>
                    <span class="option-text">Diabetes</span>
                </div>
                <div class="option-btn" onclick="toggleHistorico(this, 'nenhum')">
                    <span class="option-icon">‚úÖ</span>
                    <span class="option-text">Nenhum</span>
                    <span class="option-desc">Sem hist√≥rico</span>
                </div>
            </div>

            <div class="btn-container">
                <button class="btn btn-secondary" onclick="prevStep(6)">Voltar</button>
                <button class="btn btn-primary" onclick="nextStep(6)" id="btnStep6">Continuar</button>
            </div>
        </div>

        <!-- Step 7: Coberturas -->
        <div class="step-card" id="step7">
            <div class="step-icon">üõ°Ô∏è</div>
            <h2 class="step-title">Coberturas adicionais</h2>
            <p class="step-subtitle">A cobertura b√°sica (morte) j√° est√° inclusa. Escolha prote√ß√µes extras:</p>
            
            <div id="coverageOptions">
                <!-- Preenchido via JS com recomenda√ß√µes personalizadas -->
            </div>

            <div class="btn-container">
                <button class="btn btn-secondary" onclick="prevStep(7)">Voltar</button>
                <button class="btn btn-primary" onclick="calcularResultado()">Ver minha an√°lise</button>
            </div>
        </div>

        <!-- Step 8: Resultado -->
        <div class="step-card" id="step8">
            <div class="step-icon">üìä</div>
            <h2 class="step-title"><span id="resultName"></span>, sua an√°lise personalizada</h2>
            
            <!-- Score de Prote√ß√£o -->
            <div class="protection-score">
                <div class="score-title">√çndice de Prote√ß√£o Familiar</div>
                <div class="score-circle" id="scoreCircle" style="--score-percent: 75%">
                    <span class="score-value" id="scoreValue">75%</span>
                </div>
                <div class="score-label" id="scoreLabel">Prote√ß√£o adequada</div>
                <div class="score-factors" id="scoreFactors">
                    <!-- Preenchido via JS -->
                </div>
            </div>

            <!-- Recomenda√ß√£o -->
            <div class="recommendation-card">
                <div class="recommendation-header">
                    <div class="recommendation-icon">üí°</div>
                    <div>
                        <div class="recommendation-title">Nossa recomenda√ß√£o</div>
                        <div class="recommendation-subtitle">Baseado no seu perfil</div>
                    </div>
                </div>
                <div class="recommendation-content">
                    <div class="recommendation-item">
                        <span class="recommendation-value" id="capitalRecomendado">R$ 300k</span>
                        <span class="recommendation-text" id="capitalExplicacao">Capital ideal para proteger sua fam√≠lia por 5 anos</span>
                    </div>
                </div>
            </div>

            <!-- Valor -->
            <div class="result-card">
                <div class="result-label">Investimento mensal estimado</div>
                <div class="result-value" id="resultValue">R$ 65 - R$ 95</div>
                <div class="result-installment">d√©bito autom√°tico ou boleto</div>
            </div>

            <!-- Resumo -->
            <div class="summary-list" id="summaryList"></div>

            <a href="#" class="whatsapp-btn" id="whatsappBtn" target="_blank">
                <svg width="24" height="24" viewBox="0 0 24 24" fill="currentColor">
                    <path d="M17.472 14.382c-.297-.149-1.758-.867-2.03-.967-.273-.099-.471-.148-.67.15-.197.297-.767.966-.94 1.164-.173.199-.347.223-.644.075-.297-.15-1.255-.463-2.39-1.475-.883-.788-1.48-1.761-1.653-2.059-.173-.297-.018-.458.13-.606.134-.133.298-.347.446-.52.149-.174.198-.298.298-.497.099-.198.05-.371-.025-.52-.075-.149-.669-1.612-.916-2.207-.242-.579-.487-.5-.669-.51-.173-.008-.371-.01-.57-.01-.198 0-.52.074-.792.372-.272.297-1.04 1.016-1.04 2.479 0 1.462 1.065 2.875 1.213 3.074.149.198 2.096 3.2 5.077 4.487.709.306 1.262.489 1.694.625.712.227 1.36.195 1.871.118.571-.085 1.758-.719 2.006-1.413.248-.694.248-1.289.173-1.413-.074-.124-.272-.198-.57-.347m-5.421 7.403h-.004a9.87 9.87 0 01-5.031-1.378l-.361-.214-3.741.982.998-3.648-.235-.374a9.86 9.86 0 01-1.51-5.26c.001-5.45 4.436-9.884 9.888-9.884 2.64 0 5.122 1.03 6.988 2.898a9.825 9.825 0 012.893 6.994c-.003 5.45-4.437 9.884-9.885 9.884m8.413-18.297A11.815 11.815 0 0012.05 0C5.495 0 .16 5.335.157 11.892c0 2.096.547 4.142 1.588 5.945L.057 24l6.305-1.654a11.882 11.882 0 005.683 1.448h.005c6.554 0 11.89-5.335 11.893-11.893a11.821 11.821 0 00-3.48-8.413z"/>
                </svg>
                Falar com especialista
            </a>

            <div class="info-tooltip">
                Um especialista vai analisar seu perfil e encontrar as melhores op√ß√µes do mercado para voc√™.
            </div>
        </div>
    </div>

    <script>
        // Firebase Config
        const firebaseConfig = {
            apiKey: "AIzaSyB5Q-PbJOH54SnssnFfaVgayXuLOgDCoBc",
            authDomain: "cotador-seguros-aacb6.firebaseapp.com",
            projectId: "cotador-seguros-aacb6",
            storageBucket: "cotador-seguros-aacb6.firebasestorage.app",
            messagingSenderId: "547890075498",
            appId: "1:547890075498:web:7f866448c03ae37d3ac498"
        };

        firebase.initializeApp(firebaseConfig);
        const db = firebase.firestore();

        // Form Data
        let currentStep = 1;
        const totalSteps = 8;
        
        const formData = {
            nome: '',
            idade: '',
            familia: '',
            profissao: '',
            renda: '',
            historico: [],
            coberturas: [],
            capitalRecomendado: 0,
            valorEstimadoMin: 0,
            valorEstimadoMax: 0,
            score: 0
        };

        // Progress
        function updateProgress() {
            const percent = (currentStep / totalSteps) * 100;
            document.getElementById('progressBar').style.width = `${percent}%`;
            document.getElementById('progressText').textContent = `Passo ${currentStep} de ${totalSteps}`;
        }

        function showStep(step) {
            document.querySelectorAll('.step-card').forEach(card => card.classList.remove('active'));
            document.getElementById(`step${step}`).classList.add('active');
            currentStep = step;
            updateProgress();
            
            // Gerar coberturas personalizadas no step 7
            if (step === 7) {
                gerarCoberturasPersonalizadas();
            }
        }

        function nextStep(step) {
            if (step === 1) {
                formData.nome = document.getElementById('userName').value.trim();
                document.getElementById('greetingName').textContent = formData.nome.split(' ')[0];
            }
            showStep(step + 1);
        }

        function prevStep(step) {
            showStep(step - 1);
        }

        function selectOption(element, field, value) {
            const parent = element.parentElement;
            parent.querySelectorAll('.option-btn').forEach(btn => btn.classList.remove('selected'));
            element.classList.add('selected');
            formData[field] = value;
            
            const btnId = `btnStep${currentStep}`;
            const btn = document.getElementById(btnId);
            if (btn) btn.disabled = false;
        }

        function toggleHistorico(element, value) {
            if (value === 'nenhum') {
                // Se clicar em "nenhum", desmarca todos os outros
                const parent = element.parentElement;
                parent.querySelectorAll('.option-btn').forEach(btn => btn.classList.remove('selected'));
                element.classList.add('selected');
                formData.historico = ['nenhum'];
            } else {
                // Se clicar em outro, remove "nenhum"
                const parent = element.parentElement;
                parent.querySelectorAll('.option-btn').forEach(btn => {
                    if (btn.querySelector('.option-text').textContent === 'Nenhum') {
                        btn.classList.remove('selected');
                    }
                });
                formData.historico = formData.historico.filter(h => h !== 'nenhum');
                
                element.classList.toggle('selected');
                
                if (element.classList.contains('selected')) {
                    if (!formData.historico.includes(value)) {
                        formData.historico.push(value);
                    }
                } else {
                    formData.historico = formData.historico.filter(h => h !== value);
                }
            }
        }

        function toggleCobertura(element, value) {
            element.classList.toggle('selected');
            
            if (element.classList.contains('selected')) {
                if (!formData.coberturas.includes(value)) {
                    formData.coberturas.push(value);
                }
            } else {
                formData.coberturas = formData.coberturas.filter(c => c !== value);
            }
        }

        function gerarCoberturasPersonalizadas() {
            const container = document.getElementById('coverageOptions');
            const temHistoricoDoencas = formData.historico.some(h => ['cardiaco', 'cancer', 'diabetes'].includes(h));
            const temFilhos = ['filhos_pequenos', 'filhos_adultos'].includes(formData.familia);
            const filhosPequenos = formData.familia === 'filhos_pequenos';
            
            let html = '';
            
            // IPA - Invalidez
            html += `
                <div class="coverage-card ${filhosPequenos ? 'recommended' : ''}" onclick="toggleCobertura(this, 'invalidez')">
                    <div class="coverage-header">
                        <div class="coverage-checkbox"></div>
                        <span class="coverage-title">‚ôø Invalidez por Acidente (IPA)</span>
                    </div>
                    <p class="coverage-explain">Se voc√™ sofrer um acidente e ficar impossibilitado de trabalhar, recebe o capital segurado em vida.</p>
                    <div class="coverage-example">
                        <strong>Exemplo:</strong> Um acidente de tr√¢nsito deixa voc√™ com invalidez permanente. Voc√™ recebe R$ 200.000 para adaptar sua casa e garantir sua renda.
                    </div>
                </div>
            `;
            
            // Doen√ßas Graves - Recomendado se tem hist√≥rico
            html += `
                <div class="coverage-card ${temHistoricoDoencas ? 'recommended' : ''}" onclick="toggleCobertura(this, 'doencas')">
                    <div class="coverage-header">
                        <div class="coverage-checkbox"></div>
                        <span class="coverage-title">üè• Doen√ßas Graves</span>
                    </div>
                    <p class="coverage-explain">Antecipa parte do capital se voc√™ for diagnosticado com c√¢ncer, infarto, AVC ou outras condi√ß√µes graves. O dinheiro √© seu para usar como quiser.</p>
                    <div class="coverage-example">
                        <strong>Exemplo:</strong> Diagn√≥stico de c√¢ncer em est√°gio inicial. Voc√™ recebe R$ 150.000 para tratamento, sem precisar usar a cobertura de morte.
                    </div>
                </div>
            `;
            
            // Assist√™ncia Funeral - Recomendado para quem tem fam√≠lia
            html += `
                <div class="coverage-card ${temFilhos ? 'recommended' : ''}" onclick="toggleCobertura(this, 'funeral')">
                    <div class="coverage-header">
                        <div class="coverage-checkbox"></div>
                        <span class="coverage-title">‚ö±Ô∏è Assist√™ncia Funeral Familiar</span>
                    </div>
                    <p class="coverage-explain">Cobre todas as despesas do funeral para voc√™ e fam√≠lia (c√¥njuge, filhos, pais). A seguradora cuida de tudo em um momento dif√≠cil.</p>
                    <div class="coverage-example">
                        <strong>Inclui:</strong> Translado, vel√≥rio, sepultamento ou crema√ß√£o. Cobertura m√©dia de R$ 7.000 por pessoa.
                    </div>
                </div>
            `;
            
            // DIH - Di√°ria de Interna√ß√£o
            html += `
                <div class="coverage-card" onclick="toggleCobertura(this, 'diaria')">
                    <div class="coverage-header">
                        <div class="coverage-checkbox"></div>
                        <span class="coverage-title">üè® Di√°ria de Interna√ß√£o (DIH)</span>
                    </div>
                    <p class="coverage-explain">Receba um valor por dia que ficar internado em hospital ou UTI. Ajuda a cobrir despesas extras durante a recupera√ß√£o.</p>
                    <div class="coverage-example">
                        <strong>Exemplo:</strong> Interna√ß√£o de 10 dias = voc√™ recebe R$ 3.000 (R$ 300/dia) para cobrir gastos extras, transporte da fam√≠lia, etc.
                    </div>
                </div>
            `;
            
            container.innerHTML = html;
            
            // Auto-selecionar os recomendados
            document.querySelectorAll('.coverage-card.recommended').forEach(card => {
                card.classList.add('selected');
                const value = card.getAttribute('onclick').match(/'(\w+)'/)[1];
                if (!formData.coberturas.includes(value)) {
                    formData.coberturas.push(value);
                }
            });
        }

        function calcularCapitalRecomendado() {
            // Pegar renda anual
            let rendaAnual = 0;
            switch (formData.renda) {
                case '3000': rendaAnual = 36000; break;
                case '5000': rendaAnual = 60000; break;
                case '8000': rendaAnual = 96000; break;
                case '12000': rendaAnual = 144000; break;
                case '20000': rendaAnual = 240000; break;
                case '30000': rendaAnual = 360000; break;
            }
            
            // Multiplicador por situa√ß√£o familiar
            let multiplicador = 5; // Base: 5 anos de renda
            
            if (formData.familia === 'filhos_pequenos') {
                multiplicador = 10; // Filhos pequenos: 10 anos
            } else if (formData.familia === 'casal') {
                multiplicador = 7;
            } else if (formData.familia === 'filhos_adultos') {
                multiplicador = 5;
            } else if (formData.familia === 'solteiro') {
                multiplicador = 3;
            }
            
            const capital = rendaAnual * multiplicador;
            
            // Arredondar para valores de mercado
            if (capital <= 50000) return 50000;
            if (capital <= 100000) return 100000;
            if (capital <= 150000) return 150000;
            if (capital <= 200000) return 200000;
            if (capital <= 300000) return 300000;
            if (capital <= 500000) return 500000;
            if (capital <= 750000) return 750000;
            return 1000000;
        }

        function calcularScore() {
            let score = 50; // Base
            const fatores = [];
            
            // Fam√≠lia
            if (formData.familia === 'filhos_pequenos') {
                score += 15;
                fatores.push({ text: 'Filhos dependentes', type: 'warning' });
            } else if (formData.familia === 'casal') {
                score += 10;
                fatores.push({ text: 'C√¥njuge dependente', type: 'positive' });
            }
            
            // Coberturas
            if (formData.coberturas.includes('invalidez')) {
                score += 10;
                fatores.push({ text: 'Prote√ß√£o invalidez', type: 'positive' });
            }
            if (formData.coberturas.includes('doencas')) {
                score += 10;
                fatores.push({ text: 'Doen√ßas graves', type: 'positive' });
            }
            if (formData.coberturas.includes('funeral')) {
                score += 5;
            }
            
            // Hist√≥rico
            if (formData.historico.includes('cardiaco') || formData.historico.includes('cancer')) {
                if (!formData.coberturas.includes('doencas')) {
                    score -= 10;
                    fatores.push({ text: 'Hist√≥rico familiar', type: 'warning' });
                }
            }
            
            // Profiss√£o
            if (formData.profissao === 'autonomo' || formData.profissao === 'empresario') {
                score += 5;
                fatores.push({ text: 'Sem CLT', type: 'warning' });
            }
            
            return { score: Math.min(100, Math.max(0, score)), fatores };
        }

        function calcularResultado() {
            const capitalRecomendado = calcularCapitalRecomendado();
            formData.capitalRecomendado = capitalRecomendado;
            
            // Calcular valor base mensal
            let valorBase = (capitalRecomendado / 1000) * 0.35; // ~0.35 por mil
            
            // Ajuste por idade
            let multIdade = 1.0;
            switch (formData.idade) {
                case '18-30': multIdade = 0.7; break;
                case '31-40': multIdade = 1.0; break;
                case '41-50': multIdade = 1.5; break;
                case '51-60': multIdade = 2.2; break;
                case '61-65': multIdade = 3.0; break;
                case '66+': multIdade = 4.0; break;
            }
            
            valorBase *= multIdade;
            
            // Coberturas extras
            if (formData.coberturas.includes('invalidez')) valorBase *= 1.25;
            if (formData.coberturas.includes('doencas')) valorBase *= 1.35;
            if (formData.coberturas.includes('funeral')) valorBase += 18;
            if (formData.coberturas.includes('diaria')) valorBase += 12;
            
            const min = Math.round(valorBase * 0.85);
            const max = Math.round(valorBase * 1.15);
            
            formData.valorEstimadoMin = min;
            formData.valorEstimadoMax = max;
            
            // Score
            const { score, fatores } = calcularScore();
            formData.score = score;
            
            // Atualizar UI
            document.getElementById('resultName').textContent = formData.nome.split(' ')[0];
            document.getElementById('resultValue').textContent = `R$ ${min.toLocaleString('pt-BR')} - R$ ${max.toLocaleString('pt-BR')}`;
            
            // Capital recomendado
            const capitalFormatado = capitalRecomendado >= 1000000 
                ? `R$ ${(capitalRecomendado/1000000).toFixed(1)}M` 
                : `R$ ${(capitalRecomendado/1000).toFixed(0)}k`;
            document.getElementById('capitalRecomendado').textContent = capitalFormatado;
            
            // Explica√ß√£o do capital
            let explicacao = '';
            if (formData.familia === 'filhos_pequenos') {
                explicacao = 'Capital para proteger seus filhos at√© a vida adulta (10 anos de renda)';
            } else if (formData.familia === 'casal') {
                explicacao = 'Capital para seu c√¥njuge se reorganizar (7 anos de renda)';
            } else if (formData.familia === 'filhos_adultos') {
                explicacao = 'Capital para despesas finais e heran√ßa (5 anos de renda)';
            } else {
                explicacao = 'Capital para cobrir despesas e deixar tudo em ordem (3 anos de renda)';
            }
            document.getElementById('capitalExplicacao').textContent = explicacao;
            
            // Score visual
            document.getElementById('scoreCircle').style.setProperty('--score-percent', `${score}%`);
            document.getElementById('scoreValue').textContent = `${score}%`;
            
            let scoreLabel = '';
            if (score >= 80) scoreLabel = 'Prote√ß√£o excelente! üèÜ';
            else if (score >= 60) scoreLabel = 'Prote√ß√£o adequada ‚úÖ';
            else if (score >= 40) scoreLabel = 'Prote√ß√£o b√°sica ‚ö†Ô∏è';
            else scoreLabel = 'Prote√ß√£o insuficiente ‚ùå';
            document.getElementById('scoreLabel').textContent = scoreLabel;
            
            // Fatores do score
            const fatoresHtml = fatores.map(f => 
                `<span class="score-factor ${f.type}">${f.text}</span>`
            ).join('');
            document.getElementById('scoreFactors').innerHTML = fatoresHtml;
            
            // Resumo
            const idadeLabels = {
                '18-30': '18 a 30 anos',
                '31-40': '31 a 40 anos',
                '41-50': '41 a 50 anos',
                '51-60': '51 a 60 anos',
                '61-65': '61 a 65 anos',
                '66+': 'Acima de 65'
            };
            
            const familiaLabels = {
                'solteiro': 'Solteiro(a)',
                'casal': 'Casado(a), sem filhos',
                'filhos_pequenos': 'Filhos menores de 18',
                'filhos_adultos': 'Filhos adultos'
            };
            
            const coberturasLabels = [];
            coberturasLabels.push('Morte natural e acidental');
            if (formData.coberturas.includes('invalidez')) coberturasLabels.push('Invalidez (IPA)');
            if (formData.coberturas.includes('doencas')) coberturasLabels.push('Doen√ßas Graves');
            if (formData.coberturas.includes('funeral')) coberturasLabels.push('Funeral Familiar');
            if (formData.coberturas.includes('diaria')) coberturasLabels.push('Di√°ria Interna√ß√£o');
            
            let summaryHTML = `
                <div class="summary-item">
                    <span class="summary-label">Idade</span>
                    <span class="summary-value">${idadeLabels[formData.idade]}</span>
                </div>
                <div class="summary-item">
                    <span class="summary-label">Situa√ß√£o familiar</span>
                    <span class="summary-value">${familiaLabels[formData.familia]}</span>
                </div>
                <div class="summary-item">
                    <span class="summary-label">Capital recomendado</span>
                    <span class="summary-value">R$ ${capitalRecomendado.toLocaleString('pt-BR')}</span>
                </div>
                <div class="summary-item">
                    <span class="summary-label">Coberturas</span>
                    <span class="summary-value">${coberturasLabels.join(', ')}</span>
                </div>
            `;
            document.getElementById('summaryList').innerHTML = summaryHTML;
            
            // WhatsApp
            const primeiroNome = formData.nome.split(' ')[0];
            const valorEstimado = `R$ ${min} a R$ ${max}/m√™s`;
            
            const mensagem = `Ol√° Retorno! Eu sou o(a) ${primeiroNome} üëã\n\n` +
                `Fiz a an√°lise de seguro de vida no site.\n\n` +
                `üìä Meu perfil:\n` +
                `‚Ä¢ Idade: ${idadeLabels[formData.idade]}\n` +
                `‚Ä¢ Fam√≠lia: ${familiaLabels[formData.familia]}\n` +
                `‚Ä¢ Capital sugerido: R$ ${capitalRecomendado.toLocaleString('pt-BR')}\n` +
                `‚Ä¢ Score: ${score}%\n\n` +
                `üí∞ Estimativa: ${valorEstimado}\n\n` +
                `Podem me ajudar a encontrar o melhor plano?`;
            
            const whatsappUrl = `https://wa.me/5554996454300?text=${encodeURIComponent(mensagem)}`;
            document.getElementById('whatsappBtn').href = whatsappUrl;
            
            // Salvar lead
            salvarLead();
            
            showStep(8);
        }

        async function salvarLead() {
            try {
                await db.collection('leads_cotacao_vida').add({
                    nome: formData.nome,
                    idade: formData.idade,
                    familia: formData.familia,
                    profissao: formData.profissao,
                    renda: formData.renda,
                    historico: formData.historico,
                    coberturas: formData.coberturas,
                    capitalRecomendado: formData.capitalRecomendado,
                    score: formData.score,
                    valorEstimado: {
                        min: formData.valorEstimadoMin,
                        max: formData.valorEstimadoMax
                    },
                    status: 'novo',
                    dataCriacao: firebase.firestore.FieldValue.serverTimestamp(),
                    origem: 'site_cotacao_vida_v2'
                });
                console.log('Lead salvo com sucesso');
            } catch (error) {
                console.error('Erro ao salvar lead:', error);
            }
        }

        // Init
        document.addEventListener('DOMContentLoaded', function() {
            const nameInput = document.getElementById('userName');
            nameInput.addEventListener('input', function() {
                document.getElementById('btnStep1').disabled = this.value.trim().length === 0;
            });
            document.getElementById('btnStep1').disabled = true;
            nameInput.focus();
            updateProgress();
        });
    </script>
</body>
</html>
