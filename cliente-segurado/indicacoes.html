<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Minhas Indicações - Retorno Seguros</title>
    <link rel="stylesheet" href="css/style.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
</head>
<body class="dashboard-page">
    <!-- Sidebar -->
    <aside class="sidebar" id="sidebar">
        <div class="sidebar-header">
            <img src="../img/logo-retorno.png" alt="Retorno Seguros" class="logo">
            <button class="sidebar-toggle" onclick="toggleSidebar()">
                <i class="fas fa-bars"></i>
            </button>
        </div>
        
        <nav class="sidebar-nav">
            <a href="dashboard.html" class="nav-item">
                <i class="fas fa-home"></i>
                <span>Dashboard</span>
            </a>
            <a href="indicacoes.html" class="nav-item active">
                <i class="fas fa-users"></i>
                <span>Minhas Indicações</span>
                <span class="badge" id="indicacoesBadge">0</span>
            </a>
            <a href="apolices-externas.html" class="nav-item">
                <i class="fas fa-file-contract"></i>
                <span>Apólices Externas</span>
            </a>
            <a href="apolices-retorno.html" class="nav-item">
                <i class="fas fa-shield-alt"></i>
                <span>Apólices Retorno</span>
            </a>
            <a href="campanhas.html" class="nav-item">
                <i class="fas fa-trophy"></i>
                <span>Campanhas</span>
            </a>
            <a href="resgates.html" class="nav-item">
                <i class="fas fa-money-bill-wave"></i>
                <span>Resgates</span>
            </a>
            <a href="cotacoes.html" class="nav-item">
                <i class="fas fa-calculator"></i>
                <span>Cotações</span>
            </a>
            <a href="perfil.html" class="nav-item">
                <i class="fas fa-user-cog"></i>
                <span>Meu Perfil</span>
            </a>
        </nav>
        
        <div class="sidebar-footer">
            <button class="btn-logout" onclick="logout()">
                <i class="fas fa-sign-out-alt"></i>
                <span>Sair</span>
            </button>
        </div>
    </aside>
    
    <!-- Main Content -->
    <main class="main-content">
        <!-- Top Bar -->
        <header class="top-bar">
            <div class="top-bar-left">
                <button class="mobile-menu-btn" onclick="toggleSidebar()">
                    <i class="fas fa-bars"></i>
                </button>
                <h1>Minhas Indicações</h1>
            </div>
            <div class="top-bar-right">
                <div class="user-menu">
                    <button class="user-menu-btn" onclick="toggleUserMenu()">
                        <img src="https://ui-avatars.com/api/?name=Usuario&background=0066cc&color=fff" alt="Avatar" id="userAvatar">
                        <span id="userName">Carregando...</span>
                        <i class="fas fa-chevron-down"></i>
                    </button>
                    <div class="user-dropdown" id="userDropdown">
                        <a href="perfil.html"><i class="fas fa-user"></i> Meu Perfil</a>
                        <a href="#" onclick="logout()"><i class="fas fa-sign-out-alt"></i> Sair</a>
                    </div>
                </div>
            </div>
        </header>
        
        <!-- Content -->
        <div class="dashboard-content">
            <!-- Resumo de Indicações -->
            <div class="summary-cards">
                <div class="summary-card primary">
                    <div class="card-icon">
                        <i class="fas fa-users"></i>
                    </div>
                    <div class="card-content">
                        <h3>Total de Indicações</h3>
                        <p class="card-value" id="totalIndicacoes">0</p>
                        <small class="card-subtitle">Pessoas indicadas</small>
                    </div>
                </div>
                
                <div class="summary-card warning">
                    <div class="card-icon">
                        <i class="fas fa-clock"></i>
                    </div>
                    <div class="card-content">
                        <h3>Em Andamento</h3>
                        <p class="card-value" id="indicacoesAndamento">0</p>
                        <small class="card-subtitle">Aguardando conversão</small>
                    </div>
                </div>
                
                <div class="summary-card success">
                    <div class="card-icon">
                        <i class="fas fa-check-circle"></i>
                    </div>
                    <div class="card-content">
                        <h3>Convertidas</h3>
                        <p class="card-value" id="indicacoesConvertidas">0</p>
                        <small class="card-subtitle">Viraram clientes</small>
                    </div>
                </div>
                
                <div class="summary-card info">
                    <div class="card-icon">
                        <i class="fas fa-star"></i>
                    </div>
                    <div class="card-content">
                        <h3>Pontos Ganhos</h3>
                        <p class="card-value" id="pontosIndicacoes">0</p>
                        <small class="card-subtitle">Com indicações</small>
                    </div>
                </div>
            </div>
            
            <!-- Compartilhar Código -->
            <div class="card">
                <div class="card-header">
                    <h2><i class="fas fa-share-alt"></i> Compartilhe e Ganhe Pontos</h2>
                </div>
                <div class="card-body">
                    <div class="share-section">
                        <div class="share-left">
                            <h3>Seu Código de Indicação</h3>
                            <div class="codigo-box-lg">
                                <span class="codigo-texto" id="codigoIndicacao">---------</span>
                                <button class="btn-copy" onclick="copiarCodigo()" title="Copiar código">
                                    <i class="fas fa-copy"></i>
                                </button>
                            </div>
                            <p class="share-info">
                                Cada pessoa que se cadastrar com seu código, você ganha pontos!
                            </p>
                        </div>
                        <div class="share-right">
                            <h3>Compartilhar via:</h3>
                            <div class="share-buttons">
                                <button class="btn-share whatsapp" onclick="compartilharWhatsApp()">
                                    <i class="fab fa-whatsapp"></i>
                                    <span>WhatsApp</span>
                                </button>
                                <button class="btn-share facebook" onclick="compartilharFacebook()">
                                    <i class="fab fa-facebook"></i>
                                    <span>Facebook</span>
                                </button>
                                <button class="btn-share email" onclick="compartilharEmail()">
                                    <i class="fas fa-envelope"></i>
                                    <span>E-mail</span>
                                </button>
                                <button class="btn-share link" onclick="copiarLink()">
                                    <i class="fas fa-link"></i>
                                    <span>Copiar Link</span>
                                </button>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            
            <!-- Filtros e Busca -->
            <div class="card">
                <div class="card-body">
                    <div class="filters-section">
                        <div class="search-box">
                            <i class="fas fa-search"></i>
                            <input type="text" id="searchIndicacoes" placeholder="Buscar por nome ou e-mail..." onkeyup="filtrarIndicacoes()">
                        </div>
                        <div class="filters">
                            <select id="statusFilter" onchange="filtrarIndicacoes()">
                                <option value="">Todos os status</option>
                                <option value="cadastrado">Cadastrado</option>
                                <option value="apolice_cadastrada">Apólice Cadastrada</option>
                                <option value="cotacao">Em Cotação</option>
                                <option value="cliente">Cliente</option>
                            </select>
                            <select id="periodoFilter" onchange="filtrarIndicacoes()">
                                <option value="">Todo o período</option>
                                <option value="hoje">Hoje</option>
                                <option value="semana">Esta semana</option>
                                <option value="mes">Este mês</option>
                                <option value="ano">Este ano</option>
                            </select>
                        </div>
                    </div>
                </div>
            </div>
            
            <!-- Lista de Indicações -->
            <div class="card">
                <div class="card-header">
                    <h2><i class="fas fa-list"></i> Todas as Indicações</h2>
                    <div class="header-actions">
                        <button class="btn-secondary" onclick="exportarIndicacoes()">
                            <i class="fas fa-download"></i> Exportar
                        </button>
                    </div>
                </div>
                <div class="card-body">
                    <div class="table-responsive">
                        <table class="data-table" id="tabelaIndicacoes">
                            <thead>
                                <tr>
                                    <th>Nome</th>
                                    <th>Contato</th>
                                    <th>Data Cadastro</th>
                                    <th>Status</th>
                                    <th>Pontos</th>
                                    <th>Ações</th>
                                </tr>
                            </thead>
                            <tbody id="indicacoesTableBody">
                                <tr class="loading-row">
                                    <td colspan="6" class="text-center">
                                        <i class="fas fa-spinner fa-spin"></i> Carregando indicações...
                                    </td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                </div>
            </div>
            
            <!-- Timeline de Atividades -->
            <div class="card">
                <div class="card-header">
                    <h2><i class="fas fa-history"></i> Atividades Recentes</h2>
                </div>
                <div class="card-body">
                    <div class="timeline" id="timelineAtividades">
                        <div class="empty-state">
                            <i class="fas fa-history"></i>
                            <p>Nenhuma atividade recente</p>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </main>
    
    <!-- Modal de Detalhes -->
    <div class="modal" id="modalDetalhes">
        <div class="modal-content">
            <div class="modal-header">
                <h2>Detalhes da Indicação</h2>
                <button class="modal-close" onclick="fecharModal()">
                    <i class="fas fa-times"></i>
                </button>
            </div>
            <div class="modal-body" id="modalDetalhesBody">
                <!-- Conteúdo carregado dinamicamente -->
            </div>
        </div>
    </div>
    
    <!-- Toast -->
    <div class="toast" id="toast"></div>
    
    <script type="module" src="js/indicacoes.js"></script>
</body>
</html>
