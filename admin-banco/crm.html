<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="UTF-8" />
  <title>Painel CRM — Retorno Seguros</title>
  <meta name="viewport" content="width=device-width, initial-scale=1" />

  <script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-app.js"></script>
  <script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-auth.js"></script>
  <script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-firestore.js"></script>
  <script src="js/firebase-config.js"></script>

  <!-- Charts -->
  <script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.1/dist/chart.umd.min.js"></script>

  <script src="js/crm.js" defer></script>

  <style>
    :root{ --brand:#004080; --bg:#f4f6fb; --card:#fff; --bd:#e6e8ef }
    *{ box-sizing:border-box }
    body{ margin:0; font-family:Inter,system-ui,-apple-system,Segoe UI,Roboto,Arial; background:var(--bg); color:#111 }
    .topbar{ display:flex; justify-content:space-between; align-items:center; padding:14px 18px; background:#fff; border-bottom:1px solid var(--bd) }
    .title{ color:var(--brand); font-weight:700; font-size:18px }
    .btn{ background:var(--brand); color:#fff; border:none; border-radius:10px; padding:10px 14px; cursor:pointer }
    .wrap{ padding:18px }
    .pill{ display:inline-block; background:#eef3ff; color:#214a9a; border:1px solid #d8e2ff; padding:4px 8px; border-radius:999px; font-size:12px; margin-right:6px }
    .grid{ display:grid; gap:14px }
    .kpis{ grid-template-columns:repeat(4,1fr) }
    .cards{ grid-template-columns:repeat(2,1fr) }
    .card{ background:#fff; border:1px solid var(--bd); border-radius:14px; padding:14px }
    .card h3{ margin:0 0 10px; font-size:15px; color:#222 }
    table{ width:100%; border-collapse:collapse; font-size:13px }
    th,td{ border-bottom:1px solid #f0f0f0; padding:8px 6px; text-align:left }
    .muted{ color:#666; font-size:12px }
    @media(max-width:1000px){ .kpis{ grid-template-columns:repeat(2,1fr) } .cards{ grid-template-columns:1fr } }
  </style>
</head>
<body>
  <div class="topbar">
    <div>
      <div class="title">Painel CRM — Performance & Cross-Sell</div>
      <div id="filtros" class="muted"></div>
    </div>
    <button class="btn" onclick="window.close()">Fechar</button>
  </div>

  <div class="wrap">
    <div class="grid kpis">
      <div class="card"><h3>Empresas analisadas</h3><div id="kpiEmpresas" style="font-size:26px;font-weight:700">—</div></div>
      <div class="card"><h3>% com movimento (≥1 ramo)</h3><div id="kpiMovimento" style="font-size:26px;font-weight:700">—</div></div>
      <div class="card"><h3>Produto líder (movimento)</h3><div id="kpiProduto" style="font-size:16px">—</div></div>
      <div class="card"><h3>RM mais ativo</h3><div id="kpiRM" style="font-size:16px">—</div></div>
    </div>

    <div class="grid cards" style="margin-top:14px">
      <div class="card">
        <h3>Distribuição por status</h3>
        <canvas id="chartStatus" height="180"></canvas>
      </div>
      <div class="card">
        <h3>Top Produtos — Cotados x Fechados</h3>
        <canvas id="chartProdutos" height="180"></canvas>
      </div>
      <div class="card">
        <h3>Top RMs — Cotações x Fechamentos</h3>
        <canvas id="chartRMs" height="200"></canvas>
      </div>
      <div class="card">
        <h3>Top Empresas por nº de cotações</h3>
        <table id="tblEmpresas"><thead><tr><th>Empresa</th><th>Cotações</th><th>Fechamentos</th></tr></thead><tbody></tbody></table>
      </div>
    </div>

    <div class="card" style="margin-top:14px">
      <h3>Sugestões de Cross-Sell (Top 10)</h3>
      <div class="muted" style="margin-bottom:6px">Pontuação considera “lacunas” em combos relevantes (Vida↔Saúde, Empresarial/Patrimonial↔RC/Danos Elétricos, Frota↔Vida Motorista, Dental↔Saúde etc.) e adoção média da carteira.</div>
      <table id="tblCross"><thead><tr><th>Empresa</th><th>Oportunidades</th><th>Score</th></tr></thead><tbody></tbody></table>
    </div>
  </div>
</body>
</html>
