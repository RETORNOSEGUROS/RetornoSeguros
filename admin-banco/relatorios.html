<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="UTF-8" />
  <title>Central de RelatÃ³rios â€” Retorno Seguros</title>
  <meta name="viewport" content="width=device-width, initial-scale=1" />

  <!-- Fonts -->
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link href="https://fonts.googleapis.com/css2?family=Plus+Jakarta+Sans:wght@400;500;600;700;800&display=swap" rel="stylesheet">

  <!-- Tailwind -->
  <script src="https://cdn.tailwindcss.com"></script>
  <script>
    tailwind.config = {
      theme: {
        extend: {
          fontFamily: { sans: ['Plus Jakarta Sans', 'system-ui', 'sans-serif'] },
          colors: {
            brand: { 50: '#eef2ff', 100: '#e0e7ff', 500: '#6366f1', 600: '#4f46e5', 700: '#4338ca', 800: '#3730a3' }
          }
        }
      }
    }
  </script>

  <!-- Chart.js -->
  <script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.1"></script>
  
  <!-- jsPDF + AutoTable -->
  <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf-autotable/3.8.2/jspdf.plugin.autotable.min.js"></script>
  
  <!-- SheetJS -->
  <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>

  <!-- Firebase v8 -->
  <script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-app.js"></script>
  <script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-auth.js"></script>
  <script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-firestore.js"></script>
  <script src="js/firebase-config.js"></script>

  <style>
    * { box-sizing: border-box; }
    body { font-family: 'Plus Jakarta Sans', system-ui, sans-serif; background: #f1f5f9; }
    
    ::-webkit-scrollbar { width: 6px; height: 6px; }
    ::-webkit-scrollbar-track { background: #f1f5f9; }
    ::-webkit-scrollbar-thumb { background: #cbd5e1; border-radius: 3px; }
    
    .card { background: #fff; border-radius: 16px; border: 1px solid #e2e8f0; box-shadow: 0 1px 3px rgba(0,0,0,0.04); }
    
    .kpi-card { position: relative; overflow: hidden; transition: all 0.2s; }
    .kpi-card:hover { transform: translateY(-2px); box-shadow: 0 8px 25px rgba(0,0,0,0.08); }
    .kpi-card::before { content: ''; position: absolute; top: 0; left: 0; right: 0; height: 3px; }
    .kpi-blue::before { background: linear-gradient(90deg, #3b82f6, #60a5fa); }
    .kpi-green::before { background: linear-gradient(90deg, #10b981, #34d399); }
    .kpi-amber::before { background: linear-gradient(90deg, #f59e0b, #fbbf24); }
    .kpi-rose::before { background: linear-gradient(90deg, #f43f5e, #fb7185); }
    .kpi-violet::before { background: linear-gradient(90deg, #8b5cf6, #a78bfa); }
    .kpi-cyan::before { background: linear-gradient(90deg, #06b6d4, #22d3ee); }
    .kpi-emerald::before { background: linear-gradient(90deg, #059669, #10b981); }
    .kpi-orange::before { background: linear-gradient(90deg, #ea580c, #f97316); }
    
    .delta { font-size: 11px; font-weight: 600; display: inline-flex; align-items: center; gap: 2px; }
    .delta-up { color: #059669; }
    .delta-down { color: #dc2626; }
    .delta-neutral { color: #64748b; }
    
    .input, .select {
      width: 100%;
      padding: 10px 14px;
      border: 1px solid #e2e8f0;
      border-radius: 10px;
      font-size: 14px;
      transition: all 0.15s;
      background: #fff;
    }
    .input:focus, .select:focus {
      outline: none;
      border-color: #6366f1;
      box-shadow: 0 0 0 3px rgba(99, 102, 241, 0.1);
    }
    
    .btn {
      display: inline-flex;
      align-items: center;
      gap: 8px;
      padding: 10px 18px;
      border-radius: 10px;
      font-weight: 600;
      font-size: 14px;
      cursor: pointer;
      transition: all 0.15s;
      border: none;
    }
    .btn-primary { background: linear-gradient(135deg, #4f46e5, #6366f1); color: #fff; }
    .btn-primary:hover { box-shadow: 0 4px 12px rgba(99, 102, 241, 0.3); transform: translateY(-1px); }
    .btn-secondary { background: #f1f5f9; color: #475569; }
    .btn-secondary:hover { background: #e2e8f0; }
    .btn-success { background: linear-gradient(135deg, #059669, #10b981); color: #fff; }
    .btn-sm { padding: 6px 12px; font-size: 12px; }
    
    .main-tabs { display: flex; gap: 4px; background: #e2e8f0; padding: 4px; border-radius: 12px; }
    .main-tab {
      padding: 10px 20px;
      font-weight: 600;
      font-size: 13px;
      color: #64748b;
      border-radius: 8px;
      cursor: pointer;
      transition: all 0.15s;
      white-space: nowrap;
    }
    .main-tab:hover { color: #334155; background: rgba(255,255,255,0.5); }
    .main-tab.active { color: #4f46e5; background: #fff; box-shadow: 0 1px 3px rgba(0,0,0,0.1); }
    
    .sub-tabs { display: flex; gap: 2px; border-bottom: 1px solid #e2e8f0; }
    .sub-tab {
      padding: 12px 16px;
      font-weight: 500;
      font-size: 13px;
      color: #64748b;
      border-bottom: 2px solid transparent;
      cursor: pointer;
      transition: all 0.15s;
    }
    .sub-tab:hover { color: #334155; }
    .sub-tab.active { color: #4f46e5; border-color: #4f46e5; }
    
    .table-wrap { overflow-x: auto; }
    table { width: 100%; border-collapse: collapse; }
    thead th {
      background: linear-gradient(135deg, #1e293b, #334155);
      color: #fff;
      padding: 12px 10px;
      text-align: left;
      font-size: 11px;
      font-weight: 700;
      text-transform: uppercase;
      letter-spacing: 0.05em;
      position: sticky;
      top: 0;
      cursor: pointer;
      white-space: nowrap;
    }
    thead th:hover { background: linear-gradient(135deg, #334155, #475569); }
    tbody td {
      padding: 10px;
      border-bottom: 1px solid #f1f5f9;
      font-size: 13px;
      color: #334155;
    }
    tbody tr:hover td { background: #f8fafc; }
    
    .badge {
      display: inline-flex;
      align-items: center;
      padding: 4px 10px;
      border-radius: 100px;
      font-size: 11px;
      font-weight: 600;
    }
    .badge-success { background: #dcfce7; color: #15803d; }
    .badge-warning { background: #fef3c7; color: #b45309; }
    .badge-danger { background: #fee2e2; color: #dc2626; }
    .badge-info { background: #e0e7ff; color: #4338ca; }
    .badge-muted { background: #f1f5f9; color: #64748b; }
    
    .chart-container { position: relative; height: 300px; }
    .chart-sm { height: 200px; }
    
    .compare-card { display: flex; align-items: center; gap: 12px; padding: 16px; border-radius: 12px; }
    .compare-icon { width: 48px; height: 48px; border-radius: 12px; display: flex; align-items: center; justify-content: center; font-size: 20px; }
    
    .rank-item { display: flex; align-items: center; gap: 12px; padding: 10px 12px; border-radius: 10px; transition: background 0.15s; }
    .rank-item:hover { background: #f8fafc; }
    .rank-badge { width: 28px; height: 28px; border-radius: 8px; display: flex; align-items: center; justify-content: center; font-size: 12px; font-weight: 700; }
    .rank-1 { background: linear-gradient(135deg, #fbbf24, #f59e0b); color: #fff; }
    .rank-2 { background: linear-gradient(135deg, #94a3b8, #64748b); color: #fff; }
    .rank-3 { background: linear-gradient(135deg, #f97316, #ea580c); color: #fff; }
    .rank-other { background: #f1f5f9; color: #64748b; }
    
    .loading { display: flex; flex-direction: column; align-items: center; justify-content: center; padding: 60px; color: #94a3b8; gap: 12px; }
    .spinner { width: 40px; height: 40px; border: 3px solid #e2e8f0; border-top-color: #6366f1; border-radius: 50%; animation: spin 0.8s linear infinite; }
    @keyframes spin { to { transform: rotate(360deg); } }
    
    .alert-card { border-left: 4px solid; padding: 16px; border-radius: 0 12px 12px 0; }
    .alert-danger { border-color: #ef4444; background: #fef2f2; }
    .alert-warning { border-color: #f59e0b; background: #fffbeb; }
    .alert-success { border-color: #10b981; background: #ecfdf5; }
    
    @media print {
      body { background: #fff !important; }
      .no-print { display: none !important; }
      .card { box-shadow: none !important; break-inside: avoid; }
    }
    
    @media (max-width: 768px) {
      .main-tabs { overflow-x: auto; -webkit-overflow-scrolling: touch; }
      .main-tab { padding: 8px 14px; font-size: 12px; }
    }
    
    .tab-content { display: none; }
    .tab-content.active { display: block; }
    
    .highlight-row td { background: linear-gradient(90deg, rgba(99, 102, 241, 0.1), transparent) !important; }
  </style>
</head>

<body class="min-h-screen">
  <!-- Header -->
  <header class="bg-gradient-to-r from-slate-900 via-slate-800 to-slate-900 text-white sticky top-0 z-50 no-print">
    <div class="max-w-[1800px] mx-auto px-4 lg:px-6">
      <div class="h-16 flex items-center justify-between">
        <div class="flex items-center gap-4">
          <a href="painel.html" class="flex items-center gap-2 text-white/70 hover:text-white transition-colors">
            <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M10 19l-7-7m0 0l7-7m-7 7h18"/>
            </svg>
          </a>
          <div class="w-px h-6 bg-white/20"></div>
          <h1 class="text-lg font-bold">ğŸ“Š Central de RelatÃ³rios</h1>
        </div>
        
        <div class="flex items-center gap-3">
          <span id="userInfo" class="text-sm text-white/60 hidden sm:inline"></span>
          <button id="btnExportPDF" class="btn btn-success btn-sm">
            <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 10v6m0 0l-3-3m3 3l3-3m2 8H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"/>
            </svg>
            PDF
          </button>
          <button id="btnExportExcel" class="btn btn-secondary btn-sm">
            <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 17v-2m3 2v-4m3 4v-6m2 10H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"/>
            </svg>
            Excel
          </button>
        </div>
      </div>
      
      <!-- Main Tabs -->
      <div class="pb-3 overflow-x-auto">
        <div class="main-tabs inline-flex">
          <div class="main-tab active" data-tab="comparativo" onclick="switchMainTab('comparativo')">ğŸ“ˆ Comparativo</div>
          <div class="main-tab" data-tab="gerencial" onclick="switchMainTab('gerencial')">ğŸ’¼ Gerencial</div>
          <div class="main-tab" data-tab="renovacoes" onclick="switchMainTab('renovacoes')">ğŸ”„ RenovaÃ§Ãµes</div>
          <div class="main-tab" data-tab="visitas" onclick="switchMainTab('visitas')">ğŸ“ Visitas</div>
          <div class="main-tab" data-tab="equipe" onclick="switchMainTab('equipe')">ğŸ‘¥ Equipe</div>
        </div>
      </div>
    </div>
  </header>

  <main class="max-w-[1800px] mx-auto px-4 lg:px-6 py-6">
    
    <!-- Filtros Globais -->
    <section id="filtrosGlobais" class="card mb-6 no-print">
      <div class="p-4 flex flex-wrap items-end gap-4">
        <div class="flex-1 min-w-[140px]">
          <label class="block text-xs font-semibold text-slate-500 mb-1">PerÃ­odo</label>
          <select id="fPreset" class="select" onchange="aplicarPreset()">
            <option value="ano">Este Ano</option>
            <option value="mes">Este MÃªs</option>
            <option value="trimestre">Este Trimestre</option>
            <option value="semestre">Este Semestre</option>
            <option value="mesPassado">MÃªs Passado</option>
            <option value="anoPassado">Ano Passado</option>
            <option value="custom">Personalizado</option>
          </select>
        </div>
        <div class="min-w-[130px]" id="customDateStart" style="display:none">
          <label class="block text-xs font-semibold text-slate-500 mb-1">De</label>
          <input type="date" id="fDataInicio" class="input">
        </div>
        <div class="min-w-[130px]" id="customDateEnd" style="display:none">
          <label class="block text-xs font-semibold text-slate-500 mb-1">AtÃ©</label>
          <input type="date" id="fDataFim" class="input">
        </div>
        <div class="min-w-[180px]">
          <label class="block text-xs font-semibold text-slate-500 mb-1">AgÃªncia</label>
          <select id="fAgencia" class="select">
            <option value="">Todas as AgÃªncias</option>
          </select>
        </div>
        <div class="min-w-[180px]">
          <label class="block text-xs font-semibold text-slate-500 mb-1">Gerente (RM)</label>
          <select id="fRM" class="select">
            <option value="">Todos os Gerentes</option>
          </select>
        </div>
        <div>
          <button id="btnAplicar" class="btn btn-primary">
            <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"/>
            </svg>
            Atualizar
          </button>
        </div>
      </div>
    </section>

    <!-- Loading -->
    <div id="loadingGlobal" class="loading">
      <div class="spinner"></div>
      <span>Carregando dados...</span>
    </div>

    <!-- ========== ABA COMPARATIVO ========== -->
    <div id="tabComparativo" class="tab-content active space-y-6">
      
      <!-- Seletor de ComparaÃ§Ã£o -->
      <div class="card p-4 no-print">
        <div class="flex flex-wrap items-center gap-4">
          <span class="text-sm font-semibold text-slate-600">Comparar:</span>
          <label class="flex items-center gap-2 cursor-pointer">
            <input type="radio" name="tipoComparacao" value="ano" checked onchange="mudarComparacao()">
            <span class="text-sm">Ano vs Ano Anterior</span>
          </label>
          <label class="flex items-center gap-2 cursor-pointer">
            <input type="radio" name="tipoComparacao" value="mes" onchange="mudarComparacao()">
            <span class="text-sm">MÃªs vs MÃªs Anterior</span>
          </label>
          <label class="flex items-center gap-2 cursor-pointer">
            <input type="radio" name="tipoComparacao" value="periodo" onchange="mudarComparacao()">
            <span class="text-sm">Mesmo PerÃ­odo Ano Anterior</span>
          </label>
        </div>
      </div>
      
      <!-- KPIs Comparativos -->
      <div class="grid grid-cols-2 md:grid-cols-4 lg:grid-cols-6 gap-4">
        <div class="card kpi-card kpi-blue p-4">
          <div class="text-xs font-semibold text-slate-400 uppercase">CotaÃ§Ãµes</div>
          <div id="cmpCotacoes" class="text-2xl font-bold text-slate-800 mt-1">-</div>
          <div id="cmpCotacoesDelta" class="delta mt-1"></div>
        </div>
        <div class="card kpi-card kpi-green p-4">
          <div class="text-xs font-semibold text-slate-400 uppercase">Emitidos</div>
          <div id="cmpEmitidos" class="text-2xl font-bold text-slate-800 mt-1">-</div>
          <div id="cmpEmitidosDelta" class="delta mt-1"></div>
        </div>
        <div class="card kpi-card kpi-violet p-4">
          <div class="text-xs font-semibold text-slate-400 uppercase">Valor Emitido</div>
          <div id="cmpValor" class="text-xl font-bold text-slate-800 mt-1">-</div>
          <div id="cmpValorDelta" class="delta mt-1"></div>
        </div>
        <div class="card kpi-card kpi-cyan p-4">
          <div class="text-xs font-semibold text-slate-400 uppercase">Ticket MÃ©dio</div>
          <div id="cmpTicket" class="text-xl font-bold text-slate-800 mt-1">-</div>
          <div id="cmpTicketDelta" class="delta mt-1"></div>
        </div>
        <div class="card kpi-card kpi-amber p-4">
          <div class="text-xs font-semibold text-slate-400 uppercase">ConversÃ£o</div>
          <div id="cmpConversao" class="text-2xl font-bold text-slate-800 mt-1">-</div>
          <div id="cmpConversaoDelta" class="delta mt-1"></div>
        </div>
        <div class="card kpi-card kpi-emerald p-4">
          <div class="text-xs font-semibold text-slate-400 uppercase">RenovaÃ§Ãµes</div>
          <div id="cmpRenovacoes" class="text-2xl font-bold text-slate-800 mt-1">-</div>
          <div id="cmpRenovacoesDelta" class="delta mt-1"></div>
        </div>
      </div>
      
      <!-- GrÃ¡ficos Comparativos -->
      <div class="grid grid-cols-1 lg:grid-cols-2 gap-6">
        <div class="card p-5">
          <h3 class="font-bold text-slate-800 mb-4">ğŸ“Š EvoluÃ§Ã£o Comparativa (Mensal)</h3>
          <div class="chart-container">
            <canvas id="chartComparativoEvolucao"></canvas>
          </div>
        </div>
        <div class="card p-5">
          <h3 class="font-bold text-slate-800 mb-4">ğŸ¯ Performance por Status</h3>
          <div class="chart-container">
            <canvas id="chartComparativoStatus"></canvas>
          </div>
        </div>
      </div>
      
      <!-- Comparativo por NÃ­vel -->
      <div class="card">
        <div class="sub-tabs">
          <div class="sub-tab active" data-subtab="cmpGlobal" onclick="switchSubTab('comparativo', 'cmpGlobal')">ğŸŒ Global</div>
          <div class="sub-tab" data-subtab="cmpAgencia" onclick="switchSubTab('comparativo', 'cmpAgencia')">ğŸ¦ Por AgÃªncia</div>
          <div class="sub-tab" data-subtab="cmpRM" onclick="switchSubTab('comparativo', 'cmpRM')">ğŸ‘¤ Por RM</div>
          <div class="sub-tab" data-subtab="cmpRamo" onclick="switchSubTab('comparativo', 'cmpRamo')">ğŸ“‹ Por Ramo</div>
        </div>
        
        <div id="subCmpGlobal" class="p-5">
          <div class="grid grid-cols-1 md:grid-cols-3 gap-4 mb-6">
            <div class="compare-card bg-blue-50">
              <div class="compare-icon bg-blue-100 text-blue-600">ğŸ“ˆ</div>
              <div class="flex-1">
                <div class="text-xs text-slate-500">PerÃ­odo Atual</div>
                <div id="cmpGlobalAtual" class="text-xl font-bold text-slate-800">-</div>
              </div>
            </div>
            <div class="compare-card bg-slate-100">
              <div class="compare-icon bg-slate-200 text-slate-600">ğŸ“‰</div>
              <div class="flex-1">
                <div class="text-xs text-slate-500">PerÃ­odo Anterior</div>
                <div id="cmpGlobalAnterior" class="text-xl font-bold text-slate-800">-</div>
              </div>
            </div>
            <div class="compare-card bg-emerald-50">
              <div class="compare-icon bg-emerald-100 text-emerald-600">ğŸ¯</div>
              <div class="flex-1">
                <div class="text-xs text-slate-500">VariaÃ§Ã£o</div>
                <div id="cmpGlobalVariacao" class="text-xl font-bold">-</div>
              </div>
            </div>
          </div>
          <div class="chart-container chart-sm">
            <canvas id="chartGlobalComparativo"></canvas>
          </div>
        </div>
        
        <div id="subCmpAgencia" class="p-5 hidden">
          <div class="table-wrap max-h-[400px] overflow-y-auto">
            <table>
              <thead>
                <tr>
                  <th>AgÃªncia</th>
                  <th>CotaÃ§Ãµes Atual</th>
                  <th>CotaÃ§Ãµes Ant.</th>
                  <th>Î”%</th>
                  <th>Emitidos Atual</th>
                  <th>Emitidos Ant.</th>
                  <th>Î”%</th>
                  <th>Valor Atual</th>
                  <th>Valor Ant.</th>
                  <th>Î”%</th>
                </tr>
              </thead>
              <tbody id="bodyCmpAgencia"></tbody>
            </table>
          </div>
        </div>
        
        <div id="subCmpRM" class="p-5 hidden">
          <div class="table-wrap max-h-[400px] overflow-y-auto">
            <table>
              <thead>
                <tr>
                  <th>Gerente</th>
                  <th>AgÃªncia</th>
                  <th>CotaÃ§Ãµes</th>
                  <th>Î”%</th>
                  <th>Emitidos</th>
                  <th>Î”%</th>
                  <th>Valor</th>
                  <th>Î”%</th>
                  <th>ConversÃ£o</th>
                  <th>vs MÃ©dia</th>
                </tr>
              </thead>
              <tbody id="bodyCmpRM"></tbody>
            </table>
          </div>
        </div>
        
        <div id="subCmpRamo" class="p-5 hidden">
          <div class="table-wrap max-h-[400px] overflow-y-auto">
            <table>
              <thead>
                <tr>
                  <th>Ramo</th>
                  <th>CotaÃ§Ãµes Atual</th>
                  <th>CotaÃ§Ãµes Ant.</th>
                  <th>Î”%</th>
                  <th>Valor Atual</th>
                  <th>Valor Ant.</th>
                  <th>Î”%</th>
                </tr>
              </thead>
              <tbody id="bodyCmpRamo"></tbody>
            </table>
          </div>
        </div>
      </div>
    </div>

    <!-- ========== ABA GERENCIAL ========== -->
    <div id="tabGerencial" class="tab-content space-y-6">
      
      <div class="grid grid-cols-2 md:grid-cols-4 lg:grid-cols-6 gap-4">
        <div class="card kpi-card kpi-blue p-4">
          <div class="text-xs font-semibold text-slate-400 uppercase">Total CotaÃ§Ãµes</div>
          <div id="gerCotacoes" class="text-2xl font-bold text-slate-800 mt-1">-</div>
        </div>
        <div class="card kpi-card kpi-green p-4">
          <div class="text-xs font-semibold text-slate-400 uppercase">Emitidos</div>
          <div id="gerEmitidos" class="text-2xl font-bold text-slate-800 mt-1">-</div>
        </div>
        <div class="card kpi-card kpi-violet p-4">
          <div class="text-xs font-semibold text-slate-400 uppercase">Valor Total</div>
          <div id="gerValor" class="text-xl font-bold text-slate-800 mt-1">-</div>
        </div>
        <div class="card kpi-card kpi-amber p-4">
          <div class="text-xs font-semibold text-slate-400 uppercase">Pendentes</div>
          <div id="gerPendentes" class="text-2xl font-bold text-slate-800 mt-1">-</div>
        </div>
        <div class="card kpi-card kpi-rose p-4">
          <div class="text-xs font-semibold text-slate-400 uppercase">Recusados</div>
          <div id="gerRecusados" class="text-2xl font-bold text-slate-800 mt-1">-</div>
        </div>
        <div class="card kpi-card kpi-cyan p-4">
          <div class="text-xs font-semibold text-slate-400 uppercase">ConversÃ£o</div>
          <div id="gerConversao" class="text-2xl font-bold text-slate-800 mt-1">-</div>
        </div>
      </div>
      
      <div class="grid grid-cols-1 lg:grid-cols-2 gap-6">
        <div class="card p-5">
          <h3 class="font-bold text-slate-800 mb-4">ğŸ“ˆ EvoluÃ§Ã£o Mensal (por VigÃªncia)</h3>
          <div class="chart-container"><canvas id="chartGerencialEvolucao"></canvas></div>
        </div>
        <div class="card p-5">
          <h3 class="font-bold text-slate-800 mb-4">ğŸ¯ DistribuiÃ§Ã£o por Status</h3>
          <div class="chart-container"><canvas id="chartGerencialStatus"></canvas></div>
        </div>
        <div class="card p-5">
          <h3 class="font-bold text-slate-800 mb-4">ğŸ“Š Top 10 Ramos (Valor)</h3>
          <div class="chart-container"><canvas id="chartGerencialRamo"></canvas></div>
        </div>
        <div class="card p-5">
          <h3 class="font-bold text-slate-800 mb-4">ğŸ¦ ProduÃ§Ã£o por AgÃªncia</h3>
          <div class="chart-container"><canvas id="chartGerencialAgencia"></canvas></div>
        </div>
      </div>
      
      <div class="card">
        <div class="p-4 border-b border-slate-100 flex flex-wrap items-center justify-between gap-4">
          <h3 class="font-bold text-slate-800">ğŸ“‹ Detalhamento das CotaÃ§Ãµes</h3>
          <div class="flex items-center gap-2">
            <select id="gerFiltroStatus" class="select w-40" onchange="filtrarTabelaGerencial()">
              <option value="">Todos Status</option>
            </select>
            <input type="text" id="gerBusca" class="input w-48" placeholder="Buscar..." oninput="filtrarTabelaGerencial()">
          </div>
        </div>
        <div class="table-wrap max-h-[500px] overflow-y-auto">
          <table>
            <thead>
              <tr>
                <th>Empresa</th>
                <th>AgÃªncia</th>
                <th>Gerente</th>
                <th>Ramo</th>
                <th>Valor</th>
                <th>Status</th>
                <th>VigÃªncia InÃ­cio</th>
                <th>VigÃªncia Fim</th>
              </tr>
            </thead>
            <tbody id="bodyGerencial"></tbody>
          </table>
        </div>
      </div>
    </div>

    <!-- ========== ABA RENOVAÃ‡Ã•ES ========== -->
    <div id="tabRenovacoes" class="tab-content space-y-6">
      
      <div class="grid grid-cols-1 md:grid-cols-3 gap-4">
        <div class="alert-card alert-danger">
          <div class="flex items-center gap-3">
            <span class="text-2xl">ğŸš¨</span>
            <div>
              <div class="text-sm font-semibold text-red-800">Vencendo em 7 dias</div>
              <div id="renVenc7" class="text-2xl font-bold text-red-600">-</div>
              <div id="renVenc7Valor" class="text-xs text-red-500"></div>
            </div>
          </div>
        </div>
        <div class="alert-card alert-warning">
          <div class="flex items-center gap-3">
            <span class="text-2xl">âš ï¸</span>
            <div>
              <div class="text-sm font-semibold text-amber-800">Vencendo em 30 dias</div>
              <div id="renVenc30" class="text-2xl font-bold text-amber-600">-</div>
              <div id="renVenc30Valor" class="text-xs text-amber-500"></div>
            </div>
          </div>
        </div>
        <div class="alert-card alert-success">
          <div class="flex items-center gap-3">
            <span class="text-2xl">âœ…</span>
            <div>
              <div class="text-sm font-semibold text-emerald-800">Renovados no PerÃ­odo</div>
              <div id="renRenovados" class="text-2xl font-bold text-emerald-600">-</div>
              <div id="renRenovadosValor" class="text-xs text-emerald-500"></div>
            </div>
          </div>
        </div>
      </div>
      
      <div class="grid grid-cols-2 md:grid-cols-4 gap-4">
        <div class="card kpi-card kpi-blue p-4">
          <div class="text-xs font-semibold text-slate-400 uppercase">Total Vencendo</div>
          <div id="renTotal" class="text-2xl font-bold text-slate-800 mt-1">-</div>
        </div>
        <div class="card kpi-card kpi-violet p-4">
          <div class="text-xs font-semibold text-slate-400 uppercase">Valor em Risco</div>
          <div id="renValorRisco" class="text-xl font-bold text-slate-800 mt-1">-</div>
        </div>
        <div class="card kpi-card kpi-green p-4">
          <div class="text-xs font-semibold text-slate-400 uppercase">Taxa RenovaÃ§Ã£o</div>
          <div id="renTaxa" class="text-2xl font-bold text-slate-800 mt-1">-</div>
        </div>
        <div class="card kpi-card kpi-amber p-4">
          <div class="text-xs font-semibold text-slate-400 uppercase">Ticket MÃ©dio</div>
          <div id="renTicket" class="text-xl font-bold text-slate-800 mt-1">-</div>
        </div>
      </div>
      
      <div class="grid grid-cols-1 lg:grid-cols-2 gap-6">
        <div class="card p-5">
          <h3 class="font-bold text-slate-800 mb-4">ğŸ“… Vencimentos por MÃªs</h3>
          <div class="chart-container"><canvas id="chartRenovacoesVencimentos"></canvas></div>
        </div>
        <div class="card p-5">
          <h3 class="font-bold text-slate-800 mb-4">ğŸ“Š Vencimentos por Ramo</h3>
          <div class="chart-container"><canvas id="chartRenovacoesRamo"></canvas></div>
        </div>
      </div>
      
      <div class="card">
        <div class="p-4 border-b border-slate-100 flex flex-wrap items-center justify-between gap-4">
          <h3 class="font-bold text-slate-800">ğŸ“‹ PrÃ³ximos Vencimentos</h3>
          <select id="renFiltroPeriodo" class="select w-48" onchange="filtrarRenovacoes()">
            <option value="7">PrÃ³ximos 7 dias</option>
            <option value="30" selected>PrÃ³ximos 30 dias</option>
            <option value="60">PrÃ³ximos 60 dias</option>
            <option value="90">PrÃ³ximos 90 dias</option>
            <option value="all">Todos</option>
          </select>
        </div>
        <div class="table-wrap max-h-[400px] overflow-y-auto">
          <table>
            <thead>
              <tr>
                <th>Empresa</th>
                <th>Ramo</th>
                <th>Gerente</th>
                <th>AgÃªncia</th>
                <th>Vencimento</th>
                <th>Dias</th>
                <th>PrÃªmio</th>
                <th>Seguradora</th>
              </tr>
            </thead>
            <tbody id="bodyRenovacoes"></tbody>
          </table>
        </div>
      </div>
    </div>

    <!-- ========== ABA VISITAS ========== -->
    <div id="tabVisitas" class="tab-content space-y-6">
      
      <div class="grid grid-cols-2 md:grid-cols-4 lg:grid-cols-6 gap-4">
        <div class="card kpi-card kpi-blue p-4">
          <div class="text-xs font-semibold text-slate-400 uppercase">Total Visitas</div>
          <div id="visTotal" class="text-2xl font-bold text-slate-800 mt-1">-</div>
        </div>
        <div class="card kpi-card kpi-green p-4">
          <div class="text-xs font-semibold text-slate-400 uppercase">Realizadas</div>
          <div id="visRealizadas" class="text-2xl font-bold text-slate-800 mt-1">-</div>
        </div>
        <div class="card kpi-card kpi-amber p-4">
          <div class="text-xs font-semibold text-slate-400 uppercase">Agendadas</div>
          <div id="visAgendadas" class="text-2xl font-bold text-slate-800 mt-1">-</div>
        </div>
        <div class="card kpi-card kpi-violet p-4">
          <div class="text-xs font-semibold text-slate-400 uppercase">Presenciais</div>
          <div id="visPresenciais" class="text-2xl font-bold text-slate-800 mt-1">-</div>
        </div>
        <div class="card kpi-card kpi-cyan p-4">
          <div class="text-xs font-semibold text-slate-400 uppercase">Online</div>
          <div id="visOnline" class="text-2xl font-bold text-slate-800 mt-1">-</div>
        </div>
        <div class="card kpi-card kpi-emerald p-4">
          <div class="text-xs font-semibold text-slate-400 uppercase">MÃ©dia/MÃªs</div>
          <div id="visMedia" class="text-2xl font-bold text-slate-800 mt-1">-</div>
        </div>
      </div>
      
      <div class="grid grid-cols-1 lg:grid-cols-2 gap-6">
        <div class="card p-5">
          <h3 class="font-bold text-slate-800 mb-4">ğŸ“ˆ Visitas por MÃªs</h3>
          <div class="chart-container"><canvas id="chartVisitasMes"></canvas></div>
        </div>
        <div class="card p-5">
          <h3 class="font-bold text-slate-800 mb-4">ğŸ‘¤ Visitas por Gerente</h3>
          <div class="chart-container"><canvas id="chartVisitasRM"></canvas></div>
        </div>
        <div class="card p-5">
          <h3 class="font-bold text-slate-800 mb-4">ğŸ“Š Tipos de Visita</h3>
          <div class="chart-container chart-sm"><canvas id="chartVisitasTipo"></canvas></div>
        </div>
        <div class="card p-5">
          <h3 class="font-bold text-slate-800 mb-4">ğŸ“… Visitas por Dia da Semana</h3>
          <div class="chart-container chart-sm"><canvas id="chartVisitasDia"></canvas></div>
        </div>
      </div>
      
      <div class="card">
        <div class="p-4 border-b border-slate-100">
          <h3 class="font-bold text-slate-800">ğŸ“‹ Detalhamento de Visitas</h3>
        </div>
        <div class="table-wrap max-h-[400px] overflow-y-auto">
          <table>
            <thead>
              <tr>
                <th>Data</th>
                <th>Empresa</th>
                <th>Gerente</th>
                <th>AgÃªncia</th>
                <th>Tipo</th>
                <th>ObservaÃ§Ãµes</th>
              </tr>
            </thead>
            <tbody id="bodyVisitas"></tbody>
          </table>
        </div>
      </div>
    </div>

    <!-- ========== ABA EQUIPE ========== -->
    <div id="tabEquipe" class="tab-content space-y-6">
      
      <div class="grid grid-cols-1 lg:grid-cols-3 gap-6">
        <div class="card p-5">
          <h3 class="font-bold text-slate-800 mb-4 flex items-center gap-2">
            <span class="text-xl">ğŸ†</span> Top ProduÃ§Ã£o (Valor)
          </h3>
          <div id="rankProducao" class="space-y-2"></div>
        </div>
        <div class="card p-5">
          <h3 class="font-bold text-slate-800 mb-4 flex items-center gap-2">
            <span class="text-xl">ğŸ¯</span> Top ConversÃ£o (%)
          </h3>
          <div id="rankConversao" class="space-y-2"></div>
        </div>
        <div class="card p-5">
          <h3 class="font-bold text-slate-800 mb-4 flex items-center gap-2">
            <span class="text-xl">ğŸ“Š</span> Top Volume (Qtd)
          </h3>
          <div id="rankVolume" class="space-y-2"></div>
        </div>
      </div>
      
      <div class="card p-5">
        <h3 class="font-bold text-slate-800 mb-4">ğŸ“Š MÃ©dias Comparativas</h3>
        <div class="grid grid-cols-1 md:grid-cols-3 gap-6">
          <div class="text-center p-4 bg-slate-50 rounded-xl">
            <div class="text-xs text-slate-500 uppercase font-semibold">MÃ©dia Global</div>
            <div id="eqMediaGlobal" class="text-2xl font-bold text-slate-800 mt-2">-</div>
            <div id="eqMediaGlobalConv" class="text-sm text-slate-500"></div>
          </div>
          <div class="text-center p-4 bg-blue-50 rounded-xl">
            <div class="text-xs text-blue-500 uppercase font-semibold">MÃ©dia por AgÃªncia</div>
            <div id="eqMediaAgencia" class="text-2xl font-bold text-slate-800 mt-2">-</div>
            <div id="eqMediaAgenciaConv" class="text-sm text-slate-500"></div>
          </div>
          <div class="text-center p-4 bg-violet-50 rounded-xl">
            <div class="text-xs text-violet-500 uppercase font-semibold">MÃ©dia por RM</div>
            <div id="eqMediaRM" class="text-2xl font-bold text-slate-800 mt-2">-</div>
            <div id="eqMediaRMConv" class="text-sm text-slate-500"></div>
          </div>
        </div>
      </div>
      
      <div class="card p-5">
        <h3 class="font-bold text-slate-800 mb-4">ğŸ“ˆ Performance Individual vs MÃ©dia</h3>
        <div class="chart-container"><canvas id="chartEquipeComparativo"></canvas></div>
      </div>
      
      <div class="card">
        <div class="p-4 border-b border-slate-100">
          <h3 class="font-bold text-slate-800">ğŸ‘¥ Performance Detalhada por Gerente</h3>
        </div>
        <div class="table-wrap">
          <table>
            <thead>
              <tr>
                <th>#</th>
                <th>Gerente</th>
                <th>AgÃªncia</th>
                <th>CotaÃ§Ãµes</th>
                <th>Emitidos</th>
                <th>Valor</th>
                <th>Ticket MÃ©dio</th>
                <th>ConversÃ£o</th>
                <th>vs MÃ©dia Global</th>
                <th>vs MÃ©dia AgÃªncia</th>
              </tr>
            </thead>
            <tbody id="bodyEquipe"></tbody>
          </table>
        </div>
      </div>
    </div>

  </main>

  <footer class="no-print text-center py-6 text-sm text-slate-400">
    Central de RelatÃ³rios â€” Retorno Seguros Â© <span id="footerAno"></span>
  </footer>

  <script src="js/relatorios.js"></script>
</body>
</html>
