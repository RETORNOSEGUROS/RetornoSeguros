<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="UTF-8" />
  <title>Empresas Atendidas</title>
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-app.js"></script>
  <script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-auth.js"></script>
  <script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-firestore.js"></script>
  <script src="js/firebase-config.js"></script>

  <!-- PDF -->
  <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf-autotable/3.5.25/jspdf.plugin.autotable.min.js"></script>

  <script src="js/empresas.js" defer></script>
  <style>
    :root { --brand:#004080; --bg:#f4f4f4; --card:#ffffff; --muted:#666; --bd:#d9d9d9; }
    *{ box-sizing:border-box }
    body{ font-family:Arial,system-ui,-apple-system,Segoe UI,Roboto,'Helvetica Neue'; padding:16px; background:var(--bg); margin:0 }
    .topbar{ display:flex; gap:8px; align-items:center; justify-content:space-between; margin-bottom:12px }
    .topbar-left{ display:flex; gap:8px; align-items:center }
    .btn{ border:1px solid var(--brand); background:var(--brand); color:#fff; padding:8px 12px; border-radius:8px; font-size:14px; cursor:pointer }
    .btn:active{ transform:translateY(1px) }
    h2{ color:var(--brand); margin:6px 0 4px; font-size:20px }
    .filters{ display:grid; grid-template-columns:1fr 1fr 1fr; gap:10px; margin:10px 0 6px }
    label{ font-weight:700; font-size:12px; color:#222 }
    select{ width:100%; padding:10px; border-radius:8px; border:1px solid var(--bd); background:#fff; font-size:14px }
    .table-wrap{ background:var(--card); border:1px solid var(--bd); border-radius:10px; overflow-x:auto; -webkit-overflow-scrolling:touch; box-shadow:0 1px 4px rgba(0,0,0,.06) }
    table{ width:100%; border-collapse:collapse; min-width:760px; font-size:13px }
    th,td{ border-bottom:1px solid #eee; padding:8px 6px; text-align:center; white-space:nowrap }
    thead th{ position:sticky; top:0; z-index:2; background:var(--brand); color:#fff; text-align:center }
    td:first-child,th:first-child{ position:sticky; left:0; z-index:3; background:#fff; color:#111; text-align:left; min-width:220px; font-weight:600; border-right:1px solid #eee }
    .status-verde{ background:#d4edda } .status-vermelho{ background:#f8d7da } .status-amarelo{ background:#fff3cd } .status-azul{ background:#cfe2ff } .status-cinza{ background:#f6f6f6; color:#bbb }
    .legend{ margin:6px 0 12px; font-size:12px; color:#333; background:#fff; padding:10px; border-radius:8px; border:1px solid var(--bd) }
    .legend span{ margin-right:12px; display:inline-block; line-height:1.8 }
    .badge{ display:inline-block; font-size:11px; font-weight:700; background:rgba(255,255,255,.2); color:#fff; padding:2px 6px; border-radius:999px; margin-left:6px }
    .muted{ color:var(--muted) }
    @media (max-width:640px){ .filters{ grid-template-columns:1fr } td:first-child,th:first-child{ min-width:180px } .btn{ padding:8px 10px; font-size:13px } }
  </style>
</head>
<body>
  <div class="topbar">
    <div class="topbar-left">
      <button class="btn" onclick="window.location.href='painel.html'">‚Üê Voltar ao Painel</button>
      <h2>Mapa de Produtos por Empresa</h2>
    </div>
    <div style="display:flex; gap:8px">
      <button class="btn" onclick="abrirPainelCRM()">üìä Abrir Painel CRM</button>
      <button class="btn" onclick="gerarPDF()">üìÑ Gerar PDF</button>
    </div>
  </div>

  <!-- LEGENDA em cima -->
  <div class="legend">
    <strong>Legenda:</strong><br />
    <span>üü¢ Neg√≥cio Emitido</span>
    <span>üü° Pendente (Ag√™ncia, Corretor, Seguradora, Cliente)</span>
    <span>üî¥ Recusado / Emitido Declinado</span>
    <span>üîµ Fechado / Em Emiss√£o</span>
    <span>‚ö™Ô∏è Sem cota√ß√£o</span>
  </div>

  <div class="filters">
    <div>
      <label for="filtroAgencia">Ag√™ncia</label>
      <select id="filtroAgencia"></select>
    </div>
    <div>
      <label for="filtroRM">RM</label>
      <select id="filtroRM"></select>
    </div>
    <div>
      <label for="filtroAno">Ano</label>
      <select id="filtroAno"></select>
    </div>
  </div>

  <div class="table-wrap">
    <div id="tabelaEmpresas"><div class="muted" style="padding:12px">Carregando‚Ä¶</div></div>
  </div>
</body>
</html>
